<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Architecture Checker</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600;700;800&family=Space+Grotesk:wght@600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            brand: '#F2C94C',
            'brand-dark': '#D4AB2B',
            ink: '#2B2B2B',
            stone: '#ECECEC',
            slate: '#6B7280'
          },
          fontFamily: {
            sans: ['Manrope', 'sans-serif'],
            display: ['Space Grotesk', 'sans-serif']
          }
        }
      }
    };
  </script>
</head>
<body class="m-0 min-h-screen bg-stone font-sans text-ink antialiased">
  <header class="w-full border-b-4 border-brand bg-ink text-white">
    <div class="px-6 py-8 sm:px-10 lg:px-16">
      <a href="index.html" class="inline-flex items-center gap-2 text-sm font-semibold text-[#e5e7eb] no-underline transition hover:text-brand">&larr; Back</a>
      <h1 class="mt-3 font-display text-4xl font-bold tracking-tight sm:text-5xl">Architecture Checker</h1>
      <p class="mt-2"><span class="inline-flex rounded-full border border-[#8a6412] bg-gradient-to-r from-[#ffe59c] via-[#ffd86a] to-[#f3bd2d] px-3 py-1 text-[10px] font-extrabold uppercase tracking-[0.14em] text-[#3b2a04] shadow-[0_8px_20px_rgba(195,150,35,0.45)] ring-1 ring-white/70">Prototype</span></p>
      <p class="mt-3 max-w-3xl text-[#d1d5db]">Quickly score architectural health, identify complexity hotspots, and generate focused, DDD-friendly improvement actions.</p>
    </div>
  </header>

  <main class="w-full bg-[#f3f3f3] px-6 py-10 sm:px-10 lg:px-16">
    <div class="grid grid-cols-1 gap-6 xl:grid-cols-[1.1fr_0.9fr]">
      <section class="rounded-xl border border-[#d2d2d2] bg-white p-6 shadow-[0_10px_24px_rgba(0,0,0,0.08)]">
        <h2 class="font-display text-2xl font-bold">Inputs</h2>
        <p class="mt-2 text-sm text-[#4b5563]">Rate each area from 1 (poor) to 5 (excellent). Red flags reduce overall confidence.</p>

        <div id="dimensions" class="mt-6 grid grid-cols-1 gap-4 sm:grid-cols-2"></div>

        <div class="mt-6 rounded-lg border border-[#d2d2d2] bg-[#fafafa] p-4">
          <h3 class="text-lg font-semibold">Red Flags</h3>
          <div id="flags" class="mt-3 grid grid-cols-1 gap-2 text-sm text-[#374151] sm:grid-cols-2"></div>
        </div>

        <div class="mt-6 grid grid-cols-1 gap-4 sm:grid-cols-2">
          <label class="text-sm font-semibold text-[#374151]">
            <span class="inline-flex items-center gap-1">
              System shape
              <span class="inline-flex h-5 w-5 items-center justify-center rounded-full border border-[#bdbdbd] bg-white text-[11px] font-bold text-[#555] cursor-help" title="Choose the architecture style that best matches your current system. This tunes how you interpret results.">?</span>
            </span>
            <select id="systemShape" class="mt-2 w-full rounded-lg border border-[#d2d2d2] bg-white p-2.5 text-sm">
              <option value="modular-monolith">Modular monolith</option>
              <option value="monolith">Classic monolith</option>
              <option value="hybrid">Hybrid</option>
              <option value="microservices">Microservices</option>
            </select>
          </label>
          <label class="text-sm font-semibold text-[#374151]">
            <span class="inline-flex items-center gap-1">
              Biggest current pain
              <span class="inline-flex h-5 w-5 items-center justify-center rounded-full border border-[#bdbdbd] bg-white text-[11px] font-bold text-[#555] cursor-help" title="Optional: describe the dominant architecture issue to make the summary more actionable.">?</span>
            </span>
            <input id="pain" type="text" placeholder="e.g., slow delivery across teams" class="mt-2 w-full rounded-lg border border-[#d2d2d2] bg-white p-2.5 text-sm">
          </label>
        </div>
      </section>

      <section class="rounded-xl border-2 border-brand bg-ink p-6 text-white shadow-[0_12px_30px_rgba(0,0,0,0.2)]">
        <h2 class="font-display text-2xl font-bold">Assessment</h2>
        <p id="scoreLabel" class="mt-2 text-sm text-[#d1d5db]">Fill inputs to calculate.</p>

        <div class="mt-4 rounded-lg border border-[#3c3c3c] bg-[#313131] p-4">
          <p class="text-xs uppercase tracking-wide text-[#c4c4c4]">Overall Simplicity Score</p>
          <p class="mt-2 text-4xl font-bold text-brand"><span id="scoreValue">-</span><span class="text-xl text-[#e5e7eb]"> / 5</span></p>
          <p id="scoreBand" class="mt-2 inline-block rounded-md bg-[#3f3f3f] px-2.5 py-1 text-xs font-semibold text-[#ececec]">Not scored</p>
        </div>

        <div class="mt-5">
          <h3 class="text-lg font-semibold">Priority Actions</h3>
          <div class="mt-3">
            <p class="text-xs font-semibold uppercase tracking-wide text-[#d1d5db]">Top 2 now</p>
            <ol id="actionsNow" class="mt-2 list-decimal space-y-2 pl-5 text-sm text-[#f3f4f6]"></ol>
          </div>
          <div class="mt-4">
            <p class="text-xs font-semibold uppercase tracking-wide text-[#d1d5db]">2 to do later</p>
            <ol id="actionsLater" class="mt-2 list-decimal space-y-2 pl-5 text-sm text-[#f3f4f6]"></ol>
          </div>
        </div>

        <div class="mt-5 rounded-lg border border-[#3c3c3c] bg-[#313131] p-4">
          <h3 class="text-lg font-semibold">One-Paragraph Summary</h3>
          <p id="summary" class="mt-2 text-sm text-[#e5e7eb]"></p>
          <button id="copyBtn" type="button" class="mt-3 rounded-md bg-brand px-3 py-2 text-sm font-semibold text-ink transition hover:bg-brand-dark">Copy summary</button>
          <p id="copyMsg" class="mt-2 text-xs text-[#c8c8c8]"></p>
        </div>
      </section>
    </div>
  </main>

  <footer class="w-full border-t-4 border-brand bg-ink px-6 py-6 sm:px-10 lg:px-16">
    <p class="m-0 text-sm text-[#c7c7c7]">Use this as a conversation starter, not a gate. Keep simplicity tied to outcomes.</p>
  </footer>

  <script>
    const DIMENSIONS = [
      {
        id: 'boundaries',
        label: 'Domain boundaries clarity',
        weight: 1.3,
        help: 'How clearly bounded contexts and module responsibilities are defined.',
        anchors: { one: 'Blurred', three: 'Partly clear', five: 'Explicit and stable' }
      },
      {
        id: 'coupling',
        label: 'Module/service coupling',
        weight: 1.4,
        help: 'How much one module or service depends on internal details of others.',
        anchors: { one: 'Tight and tangled', three: 'Mixed', five: 'Loose and intentional' }
      },
      {
        id: 'blastRadius',
        label: 'Change blast radius',
        weight: 1.2,
        help: 'How many components are impacted when you make a typical feature change.',
        anchors: { one: 'Wide impact', three: 'Moderate', five: 'Localized change' }
      },
      {
        id: 'testFeedback',
        label: 'Testing feedback speed',
        weight: 1.1,
        help: 'How fast and trustworthy your test cycle is during normal development.',
        anchors: { one: 'Slow/unreliable', three: 'Acceptable', five: 'Fast and trusted' }
      },
      {
        id: 'deploy',
        label: 'Deployment safety',
        weight: 1.1,
        help: 'How safe, repeatable, and reversible your release process is.',
        anchors: { one: 'Risky/manual', three: 'Mostly safe', five: 'Automated/safe' }
      },
      {
        id: 'observability',
        label: 'Observability clarity',
        weight: 1.0,
        help: 'How easily teams can detect and diagnose production issues.',
        anchors: { one: 'Opaque', three: 'Some visibility', five: 'Actionable signals' }
      },
      {
        id: 'ownership',
        label: 'Ownership clarity',
        weight: 1.0,
        help: 'How clear accountability and ownership boundaries are across the system.',
        anchors: { one: 'Unclear', three: 'Mostly clear', five: 'Clear and accountable' }
      },
      {
        id: 'dataFlow',
        label: 'Data flow simplicity',
        weight: 1.1,
        help: 'How direct and understandable data movement is across services or modules.',
        anchors: { one: 'Fragmented', three: 'Workable', five: 'Simple and explicit' }
      }
    ];

    const FLAGS = [
      {
        id: 'crossContextWrites',
        label: 'Frequent cross-context table writes',
        help: 'Teams are writing directly into data owned by another context.'
      },
      {
        id: 'coordinatedReleases',
        label: 'Release require multi-team coordination',
        help: 'A single release often requires synchronized changes across multiple teams.'
      },
      {
        id: 'slowCi',
        label: 'CI/test cycle is too slow',
        help: 'The build and test loop delays iteration and safe refactoring.'
      },
      {
        id: 'manualDeploy',
        label: 'Production deploy or rollback is manual',
        help: 'Release and recovery steps rely on manual execution.'
      },
      {
        id: 'unclearOwnership',
        label: 'Ownership is ambiguous in incidents',
        help: 'During incidents, it is unclear who owns diagnosis and resolution.'
      },
      {
        id: 'sharedEverything',
        label: 'Shared utility layer leakage',
        help: 'Shared utility modules leak domain logic and increase coupling.'
      }
    ];

    const dimensionsEl = document.getElementById('dimensions');
    const flagsEl = document.getElementById('flags');

    DIMENSIONS.forEach((d) => {
      const wrapper = document.createElement('label');
      wrapper.className = 'relative rounded-lg border border-[#d2d2d2] bg-[#fafafa] p-3 text-sm font-semibold text-[#374151]';
      wrapper.innerHTML = `${d.label}<span class="absolute right-2 top-2 inline-flex h-5 w-5 items-center justify-center rounded-full border border-[#bdbdbd] bg-white text-[11px] font-bold text-[#555] cursor-help" title="${d.help}" aria-label="Help for ${d.label}">?</span><input id="${d.id}" type="range" min="1" max="5" step="1" value="3" class="mt-2 w-full accent-[#2b2b2b]"><div class="mt-1 text-xs text-[#6b7280]">Score: <span id="${d.id}Val">3</span></div><div class="mt-2 grid grid-cols-3 gap-2 text-[11px] font-normal text-[#6b7280]"><div><span class="font-semibold text-[#374151]">1</span> ${d.anchors.one}</div><div><span class="font-semibold text-[#374151]">3</span> ${d.anchors.three}</div><div><span class="font-semibold text-[#374151]">5</span> ${d.anchors.five}</div></div>`;
      dimensionsEl.appendChild(wrapper);
    });

    FLAGS.forEach((f) => {
      const wrapper = document.createElement('label');
      wrapper.className = 'inline-flex items-start gap-2';
      wrapper.innerHTML = `<input id="${f.id}" type="checkbox" class="mt-0.5 h-4 w-4 rounded border-[#bdbdbd]"><span class="flex-1">${f.label}</span><span class="inline-flex h-5 w-5 items-center justify-center rounded-full border border-[#bdbdbd] bg-white text-[11px] font-bold text-[#555] cursor-help" title="${f.help}" aria-label="Help for ${f.label}">?</span>`;
      flagsEl.appendChild(wrapper);
    });

    const scoreValueEl = document.getElementById('scoreValue');
    const scoreBandEl = document.getElementById('scoreBand');
    const scoreLabelEl = document.getElementById('scoreLabel');
    const actionsNowEl = document.getElementById('actionsNow');
    const actionsLaterEl = document.getElementById('actionsLater');
    const summaryEl = document.getElementById('summary');
    const copyBtn = document.getElementById('copyBtn');
    const copyMsg = document.getElementById('copyMsg');

    function scoreBand(score) {
      if (score >= 4.3) return ['Excellent', 'bg-[#1f5132] text-[#d5f7e3]'];
      if (score >= 3.5) return ['Strong', 'bg-[#2f3f58] text-[#dce7ff]'];
      if (score >= 2.7) return ['At Risk', 'bg-[#664d1b] text-[#ffedba]'];
      return ['Complex/Fragile', 'bg-[#5b2d2d] text-[#ffd8d8]'];
    }

    function collect() {
      const values = {};
      DIMENSIONS.forEach((d) => {
        values[d.id] = Number(document.getElementById(d.id).value);
      });
      const flags = FLAGS.filter((f) => document.getElementById(f.id).checked).map((f) => f.id);
      const shape = document.getElementById('systemShape').value;
      const pain = document.getElementById('pain').value.trim();
      return { values, flags, shape, pain };
    }

    function recommendations(values, flags) {
      const recs = [];
      if (values.boundaries <= 3) recs.push('Define/refresh bounded contexts and explicit module APIs before adding new features.');
      if (values.coupling <= 3) recs.push('Cut high-churn cross-module dependencies with anti-corruption layers or adapter seams.');
      if (values.blastRadius <= 3) recs.push('Reduce blast radius: isolate change paths and enforce contract tests at boundaries.');
      if (values.testFeedback <= 3) recs.push('Shift to faster test-first loops: prioritize deterministic unit/service tests over heavy end-to-end paths.');
      if (values.deploy <= 3) recs.push('Automate deploy/rollback and add feature flags for safer, smaller releases.');
      if (values.observability <= 3) recs.push('Standardize telemetry by domain: logs, traces, and actionable service-level alerts.');
      if (values.ownership <= 3 || flags.includes('unclearOwnership')) recs.push('Clarify code/service ownership and on-call boundaries per module/context.');
      if (values.dataFlow <= 3) recs.push('Simplify data flow through explicit contracts and fewer integration paths.');
      if (flags.includes('coordinatedReleases')) recs.push('Decouple release dependencies so teams can ship independently.');
      if (flags.includes('manualDeploy')) recs.push('Eliminate manual production steps with scripted, repeatable pipelines.');
      if (flags.includes('sharedEverything')) recs.push('Break apart shared utility hotspots that hide domain coupling.');
      if (flags.includes('slowCi')) recs.push('Split test tiers and parallelize CI to restore fast feedback.');

      return recs.length ? recs.slice(0, 6) : ['Keep current architecture direction; focus next on incremental simplification and metrics discipline.'];
    }

    function render() {
      const { values, flags, shape, pain } = collect();

      DIMENSIONS.forEach((d) => {
        document.getElementById(`${d.id}Val`).textContent = values[d.id];
      });

      const weightTotal = DIMENSIONS.reduce((sum, d) => sum + d.weight, 0);
      const weighted = DIMENSIONS.reduce((sum, d) => sum + values[d.id] * d.weight, 0) / weightTotal;
      const penalty = Math.min(flags.length * 0.12, 0.7);
      const finalScore = Math.max(1, Math.min(5, weighted - penalty));

      scoreValueEl.textContent = finalScore.toFixed(1);
      const [bandText, bandClass] = scoreBand(finalScore);
      scoreBandEl.textContent = bandText;
      scoreBandEl.className = `mt-2 inline-block rounded-md px-2.5 py-1 text-xs font-semibold ${bandClass}`;

      scoreLabelEl.textContent = `System: ${shape.replace('-', ' ')} â€¢ ${flags.length} red flag${flags.length === 1 ? '' : 's'} selected`;

      const actionList = recommendations(values, flags);
      const topNow = actionList.slice(0, 2);
      const later = actionList.slice(2, 4);

      actionsNowEl.innerHTML = topNow.length
        ? topNow.map((a) => `<li>${a}</li>`).join('')
        : '<li>No immediate actions identified.</li>';

      actionsLaterEl.innerHTML = later.length
        ? later.map((a) => `<li>${a}</li>`).join('')
        : '<li>No deferred actions identified yet.</li>';

      const topFocus = topNow[0] || actionList[0] || 'Maintain current simplification momentum.';
      const summary = `Architecture Checker score: ${finalScore.toFixed(1)}/5 (${bandText}). Current shape: ${shape.replace('-', ' ')}. Top focus: ${topFocus}${pain ? ` Reported pain: ${pain}.` : ''}`;
      summaryEl.textContent = summary;
      copyBtn.dataset.summary = summary;
    }

    document.addEventListener('input', (e) => {
      if (e.target.matches('input[type="range"]') || e.target.matches('input[type="checkbox"]') || e.target.id === 'pain') {
        render();
      }
    });

    document.getElementById('systemShape').addEventListener('change', render);

    copyBtn.addEventListener('click', async () => {
      const text = copyBtn.dataset.summary || '';
      if (!text) return;
      try {
        if (navigator.clipboard && typeof navigator.clipboard.writeText === 'function') {
          await navigator.clipboard.writeText(text);
        } else {
          window.prompt('Copy summary:', text);
        }
        copyMsg.textContent = 'Summary copied.';
      } catch (_e) {
        copyMsg.textContent = 'Could not copy automatically.';
      }
      setTimeout(() => {
        copyMsg.textContent = '';
      }, 1800);
    });

    render();
  </script>
</body>
</html>
